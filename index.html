<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Foodie Drop Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: none; /* Prevents scrolling on mobile */
        }
        .game-container {
            background-color: #2d3748;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            padding: 20px;
            text-align: center;
            width: 95%;
            max-width: 500px;
        }
        h1 {
            color: #68d391; /* Green-400 */
            font-weight: 900;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        #score-board {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        canvas {
            background: #4a5568;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
        }
        .start-screen, .game-over-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(45, 55, 72, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            border-radius: 10px;
        }
        .start-screen p, .game-over-screen p {
            font-size: 1.2rem;
            margin: 0.5rem 0;
            padding: 0 1rem;
        }
        .start-screen .controls, .game-over-screen .controls {
            font-size: 1rem;
            color: #a0aec0;
            margin-top: 1rem;
        }
        button {
            background-color: #68d391;
            color: #1a202c;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s ease, background-color 0.2s ease;
            margin-top: 1rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        button:hover {
            background-color: #48bb78; /* Green-500 */
            transform: scale(1.05);
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>Foodie Drop!</h1>
        <div id="score-board">Score: 0</div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreBoard = document.getElementById('score-board');

        // --- Game Configuration ---
        const canvasWidth = 500;
        const canvasHeight = 600;
        canvas.width = canvasWidth;
        canvas.height = canvasHeight;

        const playerWidth = 80;
        const playerHeight = 40;
        const playerSpeed = 25;
        const itemSize = 40;
        const itemFallSpeed = 3;
        const itemSpawnRate = 1000; // milliseconds

        const goodFoods = ['üçï', 'üçî', 'üç£', 'üç©', 'üçú'];
        const badFood = 'ü•¶';

        // --- Game State ---
        let score = 0;
        let playerX = (canvasWidth - playerWidth) / 2;
        let items = [];
        let itemSpawner;
        let gameState = 'start'; // 'start', 'playing', 'gameOver'
        let animationFrameId;

        // --- Player Object ---
        const player = {
            draw: () => {
                ctx.fillStyle = '#f6e05e'; // Yellow-400
                ctx.strokeStyle = '#d69e2e'; // Yellow-600
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.moveTo(playerX, playerY);
                ctx.lineTo(playerX + playerWidth, playerY);
                ctx.lineTo(playerX + playerWidth - 10, playerY + playerHeight);
                ctx.lineTo(playerX + 10, playerY + playerHeight);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                ctx.font = '24px Nunito';
                ctx.fillStyle = '#1a202c';
                ctx.textAlign = 'center';
                ctx.fillText('üß∫', playerX + playerWidth / 2, playerY + 30);
            }
        };
        const playerY = canvasHeight - playerHeight - 10;

        // --- Game Functions ---
        function spawnItem() {
            const isGood = Math.random() > 0.2; // 80% chance for good food
            const item = {
                x: Math.random() * (canvasWidth - itemSize),
                y: -itemSize,
                emoji: isGood ? goodFoods[Math.floor(Math.random() * goodFoods.length)] : badFood,
                isGood: isGood,
                speed: itemFallSpeed + Math.random() * 2
            };
            items.push(item);
        }

        function update() {
            // Move items
            items.forEach((item, index) => {
                item.y += item.speed;

                // Collision detection
                if (item.y + itemSize > playerY &&
                    item.x < playerX + playerWidth &&
                    item.x + itemSize > playerX) {
                    
                    if (item.isGood) {
                        score += 10;
                    } else {
                        gameOver();
                    }
                    items.splice(index, 1); // Remove caught item
                }

                // Remove items that go off-screen
                if (item.y > canvasHeight) {
                    items.splice(index, 1);
                }
            });

            scoreBoard.textContent = `Score: ${score}`;
        }

        function draw() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);
            player.draw();
            
            // Draw items
            ctx.font = `${itemSize}px sans-serif`;
            items.forEach(item => {
                ctx.fillText(item.emoji, item.x, item.y);
            });
        }

        function gameLoop() {
            if (gameState !== 'playing') return;
            update();
            draw();
            animationFrameId = requestAnimationFrame(gameLoop);
        }

        function startGame() {
            gameState = 'playing';
            score = 0;
            items = [];
            playerX = (canvasWidth - playerWidth) / 2;
            scoreBoard.textContent = `Score: 0`;
            
            // Clear any previous game over screens
            const existingGameOverScreen = document.querySelector('.game-over-screen');
            if (existingGameOverScreen) existingGameOverScreen.remove();

            itemSpawner = setInterval(spawnItem, itemSpawnRate);
            gameLoop();
        }

        function gameOver() {
            gameState = 'gameOver';
            clearInterval(itemSpawner);
            cancelAnimationFrame(animationFrameId);
            
            // Show Game Over screen
            const gameOverScreen = document.createElement('div');
            gameOverScreen.className = 'game-over-screen';
            gameOverScreen.innerHTML = `
                <h2>Game Over!</h2>
                <p>Your final score is ${score}</p>
                <button id="restart-btn">Play Again</button>
            `;
            canvas.parentElement.style.position = 'relative';
            canvas.parentElement.appendChild(gameOverScreen);

            document.getElementById('restart-btn').onclick = () => {
                gameOverScreen.remove();
                startGame();
            };
        }

        function drawStartScreen() {
            const startScreen = document.createElement('div');
            startScreen.className = 'start-screen';
            startScreen.innerHTML = `
                <h2>Welcome to Foodie Drop!</h2>
                <p>Catch the yummy food (üçï, üçî) to score points.</p>
                <p>But avoid the broccoli (ü•¶)!</p>
                <p class="controls">Use ‚¨ÖÔ∏è‚û°Ô∏è arrow keys or touch to move.</p>
                <button id="start-btn">Start Game</button>
            `;
            canvas.parentElement.style.position = 'relative';
            canvas.parentElement.appendChild(startScreen);

            document.getElementById('start-btn').onclick = () => {
                startScreen.remove();
                startGame();
            };
        }

        // --- Event Listeners ---
        document.addEventListener('keydown', e => {
            if (gameState !== 'playing') return;
            if (e.key === 'ArrowLeft' && playerX > 0) {
                playerX -= playerSpeed;
            } else if (e.key === 'ArrowRight' && playerX < canvasWidth - playerWidth) {
                playerX += playerSpeed;
            }
        });

        // Touch controls
        canvas.addEventListener('touchmove', e => {
            if (gameState !== 'playing') return;
            e.preventDefault();
            const touchX = e.touches[0].clientX;
            const canvasRect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / canvasRect.width;
            let targetX = (touchX - canvasRect.left) * scaleX - (playerWidth / 2);

            // Clamp player position within canvas bounds
            if (targetX < 0) targetX = 0;
            if (targetX > canvasWidth - playerWidth) targetX = canvasWidth - playerWidth;
            
            playerX = targetX;
        }, { passive: false });

        // --- Initial Load ---
        window.onload = () => {
             drawStartScreen();
        };

    </script>
</body>
</html>
